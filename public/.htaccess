<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # ðŸ§± Archivos fÃ­sicos primero
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # âœ… API limpia: /api/menu-version/<restaurantId>
  RewriteRule ^api/menu-version/([A-Za-z0-9_-]+)$ api/menu-version.php?id=$1 [QSA,L]

  # Widget versionado: /widget/<id>/v/<version>
  RewriteRule ^widget/([A-Za-z0-9_-]+)/v/([0-9]+)$ widget/widget.php?id=$1&version=$2 [QSA,L]

  # Widget sin versiÃ³n (legacy fallback)
  RewriteRule ^widget/([A-Za-z0-9_-]+)$ /widget/widget.php?id=$1 [QSA,L]

  # âœ… MenÃº pÃºblico: /<id>
  RewriteRule ^([A-Za-z0-9_-]+)$ menu.php?id=$1 [QSA,L]
</IfModule>

# â›” Asegurar que widget.js NO sea cacheado
<IfModule mod_headers.c>
  <Files "widget.js">
    Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
    Header set Pragma "no-cache"
    Header set Expires "0"
  </Files>
</IfModule>