<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # 1️⃣ Archivos físicos primero
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # 2️⃣ Reescribir rutas del widget versionado:
  # De:  /widget/maxmenu/1752752209/widget.php
  # A:   /widget/widget.php?restaurantId=maxmenu&version=1752752209
  RewriteRule ^widget/([a-zA-Z0-9\-_]+)/([0-9]+)/widget\.php$ widget/widget.php?restaurantId=$1&version=$2 [L,QSA]

  # 3️⃣ Menú público amigable: /<restaurantId> → /menu.php?id=<restaurantId>
  RewriteRule ^([A-Za-z0-9_-]+)$ /menu.php?id=$1 [QSA,L]
</IfModule>

<IfModule mod_headers.c>
  <FilesMatch "\.js$">
    Header set Cache-Control "no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0"
    Header set Pragma "no-cache"
    Header set Expires "0"
  </FilesMatch>
</IfModule>